<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="[WPF] 팝업 알림창 MVVM 패턴으로 구현하기" /><meta name="author" content="SunhyeokChoe" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="WPF 앱에서 특정 이벤트 발생시 화면 구석에 Popup Notification이 띄워지도록 해봅시다. 소스는 Growl Alike WPF Notifications 글을 참고해 만들었습니다. MVVM 패턴에 맞도록 변환했고, 앱 전역에서 호출할 수 있도록 정적 Singleton Wrapper 클래스를 정의하였으며, 외부에서 메시지 창 출력 요청시 메시지 타입, 이미지 타입, 커스텀 메시지 등 손쉽게 호출할 수 있도록 타입 기반으로 분리해 놓았습니다. 그리고 데스크탑 우상단이 아닌 앱 기준 우상단에 팝업창이 나타나도록 했습니다(다중 모니터를 사용하는 환경에서 앱이 최초 실행된 모니터에서만 팝업창이 나타나므로)." /><meta property="og:description" content="WPF 앱에서 특정 이벤트 발생시 화면 구석에 Popup Notification이 띄워지도록 해봅시다. 소스는 Growl Alike WPF Notifications 글을 참고해 만들었습니다. MVVM 패턴에 맞도록 변환했고, 앱 전역에서 호출할 수 있도록 정적 Singleton Wrapper 클래스를 정의하였으며, 외부에서 메시지 창 출력 요청시 메시지 타입, 이미지 타입, 커스텀 메시지 등 손쉽게 호출할 수 있도록 타입 기반으로 분리해 놓았습니다. 그리고 데스크탑 우상단이 아닌 앱 기준 우상단에 팝업창이 나타나도록 했습니다(다중 모니터를 사용하는 환경에서 앱이 최초 실행된 모니터에서만 팝업창이 나타나므로)." /><link rel="canonical" href="https://sunhyeokchoe.github.io/posts/Growl-Notification/" /><meta property="og:url" content="https://sunhyeokchoe.github.io/posts/Growl-Notification/" /><meta property="og:site_name" content="Sunhyeok Choe" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-18T21:51:18+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[WPF] 팝업 알림창 MVVM 패턴으로 구현하기" /><meta name="twitter:site" content="@SunhyeokChoe" /><meta name="twitter:creator" content="@SunhyeokChoe" /><meta name="google-site-verification" content="oz2h83RZgafkaSK760iGMC02_eS2Dv7i4EdGDt1owoI" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"SunhyeokChoe"},"dateModified":"2023-01-26T18:00:43+09:00","datePublished":"2022-02-18T21:51:18+09:00","description":"WPF 앱에서 특정 이벤트 발생시 화면 구석에 Popup Notification이 띄워지도록 해봅시다. 소스는 Growl Alike WPF Notifications 글을 참고해 만들었습니다. MVVM 패턴에 맞도록 변환했고, 앱 전역에서 호출할 수 있도록 정적 Singleton Wrapper 클래스를 정의하였으며, 외부에서 메시지 창 출력 요청시 메시지 타입, 이미지 타입, 커스텀 메시지 등 손쉽게 호출할 수 있도록 타입 기반으로 분리해 놓았습니다. 그리고 데스크탑 우상단이 아닌 앱 기준 우상단에 팝업창이 나타나도록 했습니다(다중 모니터를 사용하는 환경에서 앱이 최초 실행된 모니터에서만 팝업창이 나타나므로).","headline":"[WPF] 팝업 알림창 MVVM 패턴으로 구현하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://sunhyeokchoe.github.io/posts/Growl-Notification/"},"url":"https://sunhyeokchoe.github.io/posts/Growl-Notification/"}</script><title>[WPF] 팝업 알림창 MVVM 패턴으로 구현하기 | Sunhyeok Choe</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Sunhyeok Choe"><meta name="application-name" content="Sunhyeok Choe"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/profile/thumbnail.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sunhyeok Choe</a></div><div class="site-subtitle font-italic">Dev Notes</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/SunhyeokChoe" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/SunhyeokChoe" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hackerwreckers','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[WPF] 팝업 알림창 MVVM 패턴으로 구현하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[WPF] 팝업 알림창 MVVM 패턴으로 구현하기</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/SunhyeokChoe">SunhyeokChoe</a> </em></div><div class="d-flex"><div> <span> 게시일 <em class="timeago" data-ts="1645188678" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-02-18 </em> </span> <span> 업데이트 <em class="timeago" data-ts="1674723643" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-01-26 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5536 단어"> <em>30 분</em> 읽는 시간 소요</span></div></div></div><div class="post-content"><p>WPF 앱에서 특정 이벤트 발생시 화면 구석에 Popup Notification이 띄워지도록 해봅시다. 소스는 <strong><a href="https://www.codeproject.com/Articles/499241/Growl-Alike-WPF-Notifications">Growl Alike WPF Notifications</a></strong> 글을 참고해 만들었습니다. MVVM 패턴에 맞도록 변환했고, 앱 전역에서 호출할 수 있도록 정적 Singleton Wrapper 클래스를 정의하였으며, 외부에서 메시지 창 출력 요청시 메시지 타입, 이미지 타입, 커스텀 메시지 등 손쉽게 호출할 수 있도록 타입 기반으로 분리해 놓았습니다. 그리고 데스크탑 우상단이 아닌 앱 기준 우상단에 팝업창이 나타나도록 했습니다(다중 모니터를 사용하는 환경에서 앱이 최초 실행된 모니터에서만 팝업창이 나타나므로).</p><p><img data-src="/assets/img/2022-02-18/C%23/Growl Notification/팝업 알림창 최종 결과물 예시.png" alt="팝업 알림창 최종 결과물 예시" data-proofer-ignore> <em>팝업 알림창 최종 결과물 예시</em></p><p>해당 소스에서는 default로 알림창 발생시 fade-in 효과로 2초 동안 서서히 나타나도록 되어있고, 6초동안 머물러 있다가 2초 동안 fade-out 되도록 되어 있습니다. 또한, 사용자가 fade-in 혹은 fade-out 중인 상태의 메시지 창 위에 마우스를 올리면 fade-in/out 효과가 사라지고 완전히 나타나게 됩니다. 이러한 애니메이션 효과(또는 디자인)는 입맛에 맞게 직접 수정해 사용하시면 됩니다.</p><h2 id="클래스-구조"><span class="mr-2">클래스 구조</span><a href="#클래스-구조" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>|-- Views
     |-- GrowlNotificationsView.xaml
          |-- GrowlNotificationsView.xaml.cs
|-- ViewModels
     |-- GrowlNotificationsViewModel.cs
|-- Models
     |-- Notificates
          |-- Notification.cs
          |-- Notificator.cs
          |-- NotificatorWrapper.cs
     |-- Structures
          |-- NotificationType.cs
|-- Interfaces
     |-- IWindowFunc.cs
</pre></table></code></div></div><p>※ GrowlNotificationsViewModel, Notificator, Notification 클래스에서 상속받는 ViewModelBase 클래스는 INotifyPropertyChanged 인터페이스를 구현하는 클래스입니다. RaisePropertyChanged 메서드는 따로 구현해 주시기 바랍니다.</p><h3 id="views-growlnotificationsviewxaml--growlnotificationsviewxamlcs"><span class="mr-2">Views: <strong>GrowlNotificationsView.xaml &amp; GrowlNotificationsView.xaml.cs</strong></span><a href="#views-growlnotificationsviewxaml--growlnotificationsviewxamlcs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>UserControl이 아닌 Window 형태<li>DataContext는 GrowlNotificationsViewModel.cs<li>ItemsControl에 DataContext의 Notifications가 바인딩됨</ul><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
</pre><td class="rouge-code"><pre><span class="c">&lt;!--  **GrowlNotificationsView.xaml**  --&gt;</span>

<span class="nt">&lt;Window</span> <span class="na">x:Class=</span><span class="s">"__PROJECT_NAMESPACE__"</span>
        <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml/presentation"</span>
        <span class="na">xmlns:x=</span><span class="s">"http://schemas.microsoft.com/winfx/2006/xaml"</span>
        <span class="na">xmlns:d=</span><span class="s">"http://schemas.microsoft.com/expression/blend/2008"</span>
        <span class="na">xmlns:mc=</span><span class="s">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span>
        <span class="na">xmlns:model=</span><span class="s">"clr-namespace:__PROJECT_NAMESPACE__.Models.Notificates"</span>
        <span class="na">mc:Ignorable=</span><span class="s">"d"</span>
        <span class="na">Title=</span><span class="s">"GrowlNotifications"</span> <span class="na">Height=</span><span class="s">"630"</span> <span class="na">Width=</span><span class="s">"330"</span>
        <span class="na">ShowActivated=</span><span class="s">"False"</span> <span class="na">AllowsTransparency=</span><span class="s">"True"</span> <span class="na">WindowStyle=</span><span class="s">"None"</span> <span class="na">ShowInTaskbar=</span><span class="s">"False"</span> <span class="na">Background=</span><span class="s">"Transparent"</span> <span class="na">UseLayoutRounding=</span><span class="s">"True"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Window.Resources&gt;</span>

        <span class="nt">&lt;SolidColorBrush</span> <span class="na">x:Key=</span><span class="s">"NormalBorderBrush"</span> <span class="na">Color=</span><span class="s">"Black"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;SolidColorBrush</span> <span class="na">x:Key=</span><span class="s">"DefaultedBorderBrush"</span> <span class="na">Color=</span><span class="s">"Black"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;SolidColorBrush</span> <span class="na">x:Key=</span><span class="s">"DisabledForegroundBrush"</span> <span class="na">Color=</span><span class="s">"#888"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;SolidColorBrush</span> <span class="na">x:Key=</span><span class="s">"DisabledBackgroundBrush"</span> <span class="na">Color=</span><span class="s">"#EEE"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;SolidColorBrush</span> <span class="na">x:Key=</span><span class="s">"DisabledBorderBrush"</span> <span class="na">Color=</span><span class="s">"#AAA"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;SolidColorBrush</span> <span class="na">x:Key=</span><span class="s">"WindowBackgroundBrush"</span> <span class="na">Color=</span><span class="s">"#FFF"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;SolidColorBrush</span> <span class="na">x:Key=</span><span class="s">"SelectedBackgroundBrush"</span> <span class="na">Color=</span><span class="s">"#DDD"</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;Style</span> <span class="na">x:Key=</span><span class="s">"ButtonFocusVisual"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"Control.Template"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Setter.Value&gt;</span>
                    <span class="nt">&lt;ControlTemplate&gt;</span>
                        <span class="nt">&lt;Border&gt;</span>
                            <span class="nt">&lt;Rectangle</span>
                                <span class="na">Margin=</span><span class="s">"2"</span>
                                <span class="na">StrokeThickness=</span><span class="s">"1"</span>
                                <span class="na">Stroke=</span><span class="s">"#60000000"</span>
                                <span class="na">StrokeDashArray=</span><span class="s">"1 2"</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/Border&gt;</span>
                    <span class="nt">&lt;/ControlTemplate&gt;</span>
                <span class="nt">&lt;/Setter.Value&gt;</span>
            <span class="nt">&lt;/Setter&gt;</span>
        <span class="nt">&lt;/Style&gt;</span>

        <span class="nt">&lt;LinearGradientBrush</span> <span class="na">x:Key=</span><span class="s">"CloseNormal"</span> <span class="na">StartPoint=</span><span class="s">"0.5,0"</span> <span class="na">EndPoint=</span><span class="s">"0.5,1"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;GradientStop</span> <span class="na">Color=</span><span class="s">"#2b2c2e"</span> <span class="na">Offset=</span><span class="s">"0.0"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;GradientStop</span> <span class="na">Color=</span><span class="s">"#28292b"</span> <span class="na">Offset=</span><span class="s">"1.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/LinearGradientBrush&gt;</span>
        <span class="nt">&lt;LinearGradientBrush</span> <span class="na">x:Key=</span><span class="s">"CloseOver"</span> <span class="na">StartPoint=</span><span class="s">"0.5,0"</span> <span class="na">EndPoint=</span><span class="s">"0.5,1"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;GradientStop</span> <span class="na">Color=</span><span class="s">"#68717d"</span> <span class="na">Offset=</span><span class="s">"0.0"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;GradientStop</span> <span class="na">Color=</span><span class="s">"#565d66"</span> <span class="na">Offset=</span><span class="s">"1.0"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/LinearGradientBrush&gt;</span>
        <span class="nt">&lt;SolidColorBrush</span> <span class="na">x:Key=</span><span class="s">"ClosePressed"</span> <span class="na">Color=</span><span class="s">"#1f1f1f"</span> <span class="nt">/&gt;</span>

        <span class="c">&lt;!--  닫기 버튼 스타일 --&gt;</span>
        <span class="nt">&lt;Style</span> <span class="na">x:Key=</span><span class="s">"CloseButton"</span> <span class="na">TargetType=</span><span class="s">"{x:Type Button}"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"SnapsToDevicePixels"</span> <span class="na">Value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"OverridesDefaultStyle"</span> <span class="na">Value=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"FocusVisualStyle"</span> <span class="na">Value=</span><span class="s">"{StaticResource ButtonFocusVisual}"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"MinHeight"</span> <span class="na">Value=</span><span class="s">"16"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"MinWidth"</span> <span class="na">Value=</span><span class="s">"16"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"Cursor"</span> <span class="na">Value=</span><span class="s">"Hand"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"Template"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Setter.Value&gt;</span>

                    <span class="nt">&lt;ControlTemplate</span> <span class="na">TargetType=</span><span class="s">"{x:Type Button}"</span><span class="nt">&gt;</span>

                        <span class="nt">&lt;Grid&gt;</span>
                            <span class="nt">&lt;Border</span> <span class="na">x:Name=</span><span class="s">"Border"</span> <span class="na">CornerRadius=</span><span class="s">"3"</span> <span class="na">BorderThickness=</span><span class="s">"0"</span> <span class="na">ClipToBounds=</span><span class="s">"False"</span> <span class="na">Background=</span><span class="s">"{StaticResource CloseNormal}"</span> <span class="na">BorderBrush=</span><span class="s">"{StaticResource NormalBorderBrush}"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;Border.Effect&gt;</span>
                                    <span class="nt">&lt;DropShadowEffect</span> <span class="na">ShadowDepth=</span><span class="s">"0"</span> <span class="na">Opacity=</span><span class="s">".4"</span> <span class="na">BlurRadius=</span><span class="s">"5"</span> <span class="na">Color=</span><span class="s">"Black"</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;/Border.Effect&gt;</span>
                                <span class="nt">&lt;Grid&gt;</span>
                                    <span class="nt">&lt;Image</span> <span class="na">Source=</span><span class="s">"pack://application:,,,/Resources/close.png"</span> <span class="na">IsHitTestVisible=</span><span class="s">"False"</span> <span class="na">Margin=</span><span class="s">"2"</span><span class="nt">&gt;</span>
                                        <span class="nt">&lt;Image.Effect&gt;</span>
                                            <span class="nt">&lt;DropShadowEffect</span> <span class="na">Direction=</span><span class="s">"90"</span> <span class="na">ShadowDepth=</span><span class="s">"1"</span> <span class="na">BlurRadius=</span><span class="s">"1"</span><span class="nt">/&gt;</span>
                                        <span class="nt">&lt;/Image.Effect&gt;</span>
                                    <span class="nt">&lt;/Image&gt;</span>
                                    <span class="nt">&lt;ContentPresenter</span> <span class="na">HorizontalAlignment=</span><span class="s">"Center"</span> <span class="na">VerticalAlignment=</span><span class="s">"Center"</span> <span class="na">RecognizesAccessKey=</span><span class="s">"True"</span><span class="nt">/&gt;</span>
                                <span class="nt">&lt;/Grid&gt;</span>
                            <span class="nt">&lt;/Border&gt;</span>
                        <span class="nt">&lt;/Grid&gt;</span>

                        <span class="nt">&lt;ControlTemplate.Triggers&gt;</span>
                            <span class="nt">&lt;Trigger</span> <span class="na">Property=</span><span class="s">"IsMouseOver"</span> <span class="na">Value=</span><span class="s">"True"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;Setter</span> <span class="na">TargetName=</span><span class="s">"Border"</span> <span class="na">Property=</span><span class="s">"Background"</span> <span class="na">Value=</span><span class="s">"{StaticResource CloseOver}"</span> <span class="nt">/&gt;</span>
                            <span class="nt">&lt;/Trigger&gt;</span>
                            <span class="nt">&lt;Trigger</span> <span class="na">Property=</span><span class="s">"IsPressed"</span> <span class="na">Value=</span><span class="s">"True"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;Setter</span> <span class="na">TargetName=</span><span class="s">"Border"</span> <span class="na">Property=</span><span class="s">"Background"</span> <span class="na">Value=</span><span class="s">"{StaticResource ClosePressed}"</span> <span class="nt">/&gt;</span>
                            <span class="nt">&lt;/Trigger&gt;</span>
                            <span class="nt">&lt;Trigger</span> <span class="na">Property=</span><span class="s">"IsKeyboardFocused"</span> <span class="na">Value=</span><span class="s">"true"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;Setter</span> <span class="na">TargetName=</span><span class="s">"Border"</span> <span class="na">Property=</span><span class="s">"BorderBrush"</span> <span class="na">Value=</span><span class="s">"{StaticResource DefaultedBorderBrush}"</span> <span class="nt">/&gt;</span>
                            <span class="nt">&lt;/Trigger&gt;</span>
                            <span class="nt">&lt;Trigger</span> <span class="na">Property=</span><span class="s">"IsDefaulted"</span> <span class="na">Value=</span><span class="s">"true"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;Setter</span> <span class="na">TargetName=</span><span class="s">"Border"</span> <span class="na">Property=</span><span class="s">"BorderBrush"</span> <span class="na">Value=</span><span class="s">"{StaticResource DefaultedBorderBrush}"</span> <span class="nt">/&gt;</span>
                            <span class="nt">&lt;/Trigger&gt;</span>
                            <span class="nt">&lt;Trigger</span> <span class="na">Property=</span><span class="s">"IsEnabled"</span> <span class="na">Value=</span><span class="s">"false"</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;Setter</span> <span class="na">TargetName=</span><span class="s">"Border"</span> <span class="na">Property=</span><span class="s">"Background"</span> <span class="na">Value=</span><span class="s">"{StaticResource DisabledBackgroundBrush}"</span> <span class="nt">/&gt;</span>
                                <span class="nt">&lt;Setter</span> <span class="na">TargetName=</span><span class="s">"Border"</span> <span class="na">Property=</span><span class="s">"BorderBrush"</span> <span class="na">Value=</span><span class="s">"{StaticResource DisabledBorderBrush}"</span> <span class="nt">/&gt;</span>
                                <span class="nt">&lt;Setter</span> <span class="na">Property=</span><span class="s">"Foreground"</span> <span class="na">Value=</span><span class="s">"{StaticResource DisabledForegroundBrush}"</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;/Trigger&gt;</span>
                        <span class="nt">&lt;/ControlTemplate.Triggers&gt;</span>

                    <span class="nt">&lt;/ControlTemplate&gt;</span>

                <span class="nt">&lt;/Setter.Value&gt;</span>
            <span class="nt">&lt;/Setter&gt;</span>
        <span class="nt">&lt;/Style&gt;</span>

        <span class="nt">&lt;Storyboard</span> <span class="na">x:Key=</span><span class="s">"CollapseStoryboard"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;DoubleAnimation</span> <span class="na">From=</span><span class="s">"100"</span> <span class="na">To=</span><span class="s">"0"</span> <span class="na">Storyboard.TargetProperty=</span><span class="s">"Height"</span> <span class="na">Duration=</span><span class="s">"0:0:1"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/Storyboard&gt;</span>

        <span class="c">&lt;!--  DataType을 Notification.cs로 지정  --&gt;</span>
        <span class="nt">&lt;DataTemplate</span> <span class="na">x:Key=</span><span class="s">"MessageTemplate"</span> <span class="na">DataType=</span><span class="s">"model:Notification"</span><span class="nt">&gt;</span>

            <span class="nt">&lt;Grid</span> <span class="na">x:Name=</span><span class="s">"NotificationWindow"</span> <span class="na">Tag=</span><span class="s">"{Binding Path=Id}"</span> <span class="na">Background=</span><span class="s">"Transparent"</span> <span class="na">SizeChanged=</span><span class="s">"NotificationWindowSizeChanged"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;Border</span> <span class="na">Name=</span><span class="s">"border"</span> <span class="na">Background=</span><span class="s">"#252525"</span> <span class="na">BorderThickness=</span><span class="s">"0"</span> <span class="na">CornerRadius=</span><span class="s">"1"</span> <span class="na">Margin=</span><span class="s">"1, 5"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Border.Effect&gt;</span>
                        <span class="nt">&lt;DropShadowEffect</span> <span class="na">ShadowDepth=</span><span class="s">"0"</span> <span class="na">Opacity=</span><span class="s">"0.8"</span> <span class="na">BlurRadius=</span><span class="s">"10"</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/Border.Effect&gt;</span>
                    <span class="nt">&lt;Grid</span> <span class="na">Height=</span><span class="s">"70"</span> <span class="na">Width=</span><span class="s">"280"</span> <span class="na">Margin=</span><span class="s">"6"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;Grid.RowDefinitions&gt;</span>
                            <span class="nt">&lt;RowDefinition</span> <span class="na">Height=</span><span class="s">"Auto"</span><span class="nt">&gt;&lt;/RowDefinition&gt;</span>
                            <span class="nt">&lt;RowDefinition</span> <span class="na">Height=</span><span class="s">"*"</span><span class="nt">&gt;&lt;/RowDefinition&gt;</span>
                        <span class="nt">&lt;/Grid.RowDefinitions&gt;</span>
                        <span class="nt">&lt;Grid.ColumnDefinitions&gt;</span>
                            <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">"Auto"</span><span class="nt">&gt;&lt;/ColumnDefinition&gt;</span>
                            <span class="nt">&lt;ColumnDefinition</span> <span class="na">Width=</span><span class="s">"*"</span><span class="nt">&gt;&lt;/ColumnDefinition&gt;</span>
                        <span class="nt">&lt;/Grid.ColumnDefinitions&gt;</span>

                        <span class="c">&lt;!--  좌측 메인 이미지  --&gt;</span>
                        <span class="nt">&lt;Image</span> <span class="na">Grid.RowSpan=</span><span class="s">"2"</span> <span class="na">Source=</span><span class="s">"{Binding Path=ImageUrl}"</span> <span class="na">Margin=</span><span class="s">"0, 4, 12, 4"</span> <span class="na">Width=</span><span class="s">"60"</span><span class="nt">&gt;&lt;/Image&gt;</span>

                        <span class="c">&lt;!--  제목  --&gt;</span>
                        <span class="nt">&lt;TextBlock</span> <span class="na">Grid.Column=</span><span class="s">"1"</span> <span class="na">Text=</span><span class="s">"{Binding Path=Title}"</span>  <span class="na">TextOptions.TextRenderingMode=</span><span class="s">"ClearType"</span> <span class="na">TextOptions.TextFormattingMode=</span><span class="s">"Display"</span> <span class="na">Foreground=</span><span class="s">"White"</span>
                                   <span class="na">FontFamily=</span><span class="s">"Arial"</span> <span class="na">FontSize=</span><span class="s">"14"</span> <span class="na">FontWeight=</span><span class="s">"Bold"</span> <span class="na">VerticalAlignment=</span><span class="s">"Center"</span>  <span class="na">Margin=</span><span class="s">"2,4,4,2"</span> <span class="na">TextWrapping=</span><span class="s">"Wrap"</span> <span class="na">TextTrimming=</span><span class="s">"CharacterEllipsis"</span> <span class="nt">/&gt;</span>

                        <span class="c">&lt;!--  닫기 버튼  --&gt;</span>
                        <span class="nt">&lt;Button</span> <span class="na">x:Name=</span><span class="s">"CloseButton"</span> <span class="na">Grid.Column=</span><span class="s">"1"</span> <span class="na">Width=</span><span class="s">"16"</span> <span class="na">Height=</span><span class="s">"16"</span> <span class="na">HorizontalAlignment=</span><span class="s">"Right"</span> <span class="na">Margin=</span><span class="s">"0"</span> <span class="na">Style=</span><span class="s">"{StaticResource CloseButton}"</span> <span class="nt">/&gt;</span>

                        <span class="c">&lt;!--  본문  --&gt;</span>
                        <span class="nt">&lt;TextBlock</span> <span class="na">Grid.Row=</span><span class="s">"1"</span> <span class="na">Grid.Column=</span><span class="s">"1"</span> <span class="na">Text=</span><span class="s">"{Binding Path=Message}"</span>  <span class="na">TextOptions.TextRenderingMode=</span><span class="s">"ClearType"</span> <span class="na">TextOptions.TextFormattingMode=</span><span class="s">"Display"</span> <span class="na">Foreground=</span><span class="s">"White"</span>
                                   <span class="na">FontFamily=</span><span class="s">"Arial"</span> <span class="na">VerticalAlignment=</span><span class="s">"Center"</span>  <span class="na">Margin=</span><span class="s">"2,2,8,6"</span> <span class="na">TextWrapping=</span><span class="s">"Wrap"</span> <span class="na">TextTrimming=</span><span class="s">"CharacterEllipsis"</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/Grid&gt;</span>
                <span class="nt">&lt;/Border&gt;</span>
            <span class="nt">&lt;/Grid&gt;</span>

            <span class="nt">&lt;DataTemplate.Triggers&gt;</span>
                <span class="nt">&lt;EventTrigger</span> <span class="na">RoutedEvent=</span><span class="s">"Window.Loaded"</span> <span class="na">SourceName=</span><span class="s">"NotificationWindow"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;BeginStoryboard</span> <span class="na">x:Name=</span><span class="s">"FadeInStoryBoard"</span><span class="nt">&gt;</span>
                        <span class="nt">&lt;Storyboard&gt;</span>
                            <span class="nt">&lt;DoubleAnimation</span> <span class="na">Storyboard.TargetName=</span><span class="s">"NotificationWindow"</span> <span class="na">From=</span><span class="s">"0.01"</span> <span class="na">To=</span><span class="s">"1"</span> <span class="na">Storyboard.TargetProperty=</span><span class="s">"Opacity"</span> <span class="na">Duration=</span><span class="s">"0:0:1"</span><span class="nt">/&gt;</span>
                            <span class="nt">&lt;DoubleAnimation</span> <span class="na">Storyboard.TargetName=</span><span class="s">"NotificationWindow"</span> <span class="na">From=</span><span class="s">"1"</span> <span class="na">To=</span><span class="s">"0"</span> <span class="na">Storyboard.TargetProperty=</span><span class="s">"Opacity"</span> <span class="na">Duration=</span><span class="s">"0:0:2"</span> <span class="na">BeginTime=</span><span class="s">"0:0:6"</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/Storyboard&gt;</span>
                    <span class="nt">&lt;/BeginStoryboard&gt;</span>
                <span class="nt">&lt;/EventTrigger&gt;</span>

                <span class="nt">&lt;Trigger</span> <span class="na">Property=</span><span class="s">"IsMouseOver"</span> <span class="na">Value=</span><span class="s">"True"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Trigger.EnterActions&gt;</span>
                        <span class="nt">&lt;SeekStoryboard</span> <span class="na">Offset=</span><span class="s">"0:0:3"</span> <span class="na">BeginStoryboardName=</span><span class="s">"FadeInStoryBoard"</span> <span class="nt">/&gt;</span>
                        <span class="nt">&lt;PauseStoryboard</span> <span class="na">BeginStoryboardName=</span><span class="s">"FadeInStoryBoard"</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/Trigger.EnterActions&gt;</span>
                    <span class="nt">&lt;Trigger.ExitActions&gt;</span>
                        <span class="nt">&lt;SeekStoryboard</span> <span class="na">Offset=</span><span class="s">"0:0:3"</span> <span class="na">BeginStoryboardName=</span><span class="s">"FadeInStoryBoard"</span> <span class="nt">/&gt;</span>
                        <span class="nt">&lt;ResumeStoryboard</span> <span class="na">BeginStoryboardName=</span><span class="s">"FadeInStoryBoard"</span><span class="nt">&gt;&lt;/ResumeStoryboard&gt;</span>
                    <span class="nt">&lt;/Trigger.ExitActions&gt;</span>
                <span class="nt">&lt;/Trigger&gt;</span>

                <span class="nt">&lt;EventTrigger</span> <span class="na">RoutedEvent=</span><span class="s">"Button.Click"</span> <span class="na">SourceName=</span><span class="s">"CloseButton"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;BeginStoryboard&gt;</span>
                        <span class="nt">&lt;Storyboard&gt;</span>
                            <span class="nt">&lt;DoubleAnimation</span> <span class="na">Storyboard.TargetName=</span><span class="s">"NotificationWindow"</span> <span class="na">From=</span><span class="s">"1"</span> <span class="na">To=</span><span class="s">"0"</span> <span class="na">Storyboard.TargetProperty=</span><span class="s">"(Grid.Opacity)"</span> <span class="na">Duration=</span><span class="s">"0:0:0"</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;/Storyboard&gt;</span>
                    <span class="nt">&lt;/BeginStoryboard&gt;</span>
                <span class="nt">&lt;/EventTrigger&gt;</span>

                <span class="nt">&lt;Trigger</span> <span class="na">SourceName=</span><span class="s">"NotificationWindow"</span> <span class="na">Property=</span><span class="s">"Opacity"</span> <span class="na">Value=</span><span class="s">"0"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;Setter</span> <span class="na">TargetName=</span><span class="s">"NotificationWindow"</span> <span class="na">Property=</span><span class="s">"Visibility"</span> <span class="na">Value=</span><span class="s">"Hidden"</span><span class="nt">&gt;&lt;/Setter&gt;</span>
                    <span class="nt">&lt;Trigger.EnterActions&gt;</span>
                        <span class="nt">&lt;BeginStoryboard</span> <span class="na">Storyboard=</span><span class="s">"{StaticResource CollapseStoryboard}"</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/Trigger.EnterActions&gt;</span>
                <span class="nt">&lt;/Trigger&gt;</span>
            <span class="nt">&lt;/DataTemplate.Triggers&gt;</span>
        <span class="nt">&lt;/DataTemplate&gt;</span>

    <span class="nt">&lt;/Window.Resources&gt;</span>

    <span class="c">&lt;!--
        DataContext는 Code-Behind에서 정의됐음
        DataContext: GrowlNotificationsViewModel은 ItemsControl의 DataContext
        ItmesSource: GrowlNotificationsViewModel에서 Notification 소스에 바인딩
        ItemTemplate: 각 메시지 아이템의 속성 (각각 다른 값을 지님)
    --&gt;</span>
    <span class="nt">&lt;ItemsControl</span>
        <span class="na">x:Name=</span><span class="s">"NotificationsControl"</span>
        <span class="na">FocusVisualStyle=</span><span class="s">"{x:Null}"</span>
        <span class="na">ItemsSource=</span><span class="s">"{Binding Notifications}"</span>
        <span class="na">ItemTemplate=</span><span class="s">"{StaticResource MessageTemplate}"</span>
    <span class="nt">/&gt;</span>
<span class="nt">&lt;/Window&gt;</span>
</pre></table></code></div></div><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
</pre><td class="rouge-code"><pre><span class="c1">// **GrowlNotificationsView.xaml.cs**</span>

<span class="k">namespace</span> <span class="nn">__PROJECT_NAMESPACE__</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Windows</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Windows.Controls</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">__PROJECT_NAME__.Models.Notificates</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">__PROJECT_NAME__.ViewModels.Interfaces</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">__PROJECT_NAME__.ViewModels.Windows</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">__PROJECT_NAME__.Models.Structures</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">GrowlNotificationsView</span> <span class="p">:</span> <span class="n">Window</span>
    <span class="p">{</span>
        <span class="err">#</span><span class="n">region</span> <span class="n">fields</span>
        <span class="c1">/// &lt;summary&gt; Top margin. &lt;/summary&gt;</span>
        <span class="kt">int</span> <span class="n">_topOffset</span> <span class="p">=</span> <span class="m">20</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt; Left margin. &lt;/summary&gt;</span>
        <span class="kt">int</span> <span class="n">_leftOffset</span> <span class="p">=</span> <span class="m">335</span><span class="p">;</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">fields</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">ctors</span>
        <span class="k">public</span> <span class="nf">GrowlNotificationsView</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">DataContext</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GrowlNotificationsViewModel</span><span class="p">();</span>

            <span class="n">Initialized</span> <span class="p">+=</span> <span class="n">GrowlNotificationsView_Loaded</span><span class="p">;</span>

            <span class="nf">InitializeComponent</span><span class="p">();</span>

            <span class="k">this</span><span class="p">.</span><span class="n">Top</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">Top</span> <span class="p">+</span> <span class="n">_topOffset</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">Left</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">Left</span> <span class="p">+</span> <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="n">_leftOffset</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">ctors</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">methods</span>
        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// MainWIndow의 Location 값이 변동됐을 때 MainWindow의 Top, Left 값과 offset 값을 활용해 우상단에 고정되도록 값 조정.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">SetLocation</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="n">Top</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">Top</span> <span class="p">+</span> <span class="n">_topOffset</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">Left</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">Left</span> <span class="p">+</span> <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">Width</span> <span class="p">-</span> <span class="n">_leftOffset</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// MainWindow의 Width, Height 값이 변동됐을 때 MainWindow의 Top, Left 값과 offset 값을 활용해 우상단에 고정되도록 값 조정.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">SetActualLocation</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">WindowState</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span><span class="n">WindowState</span><span class="p">.</span><span class="n">Maximized</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="n">Top</span> <span class="p">=</span> <span class="n">_topOffset</span><span class="p">;</span>

                <span class="c1">// 두 개 이상의 모니터를 쓰는 환경에서 메인 모니터의 좌측 서브 모니터로 앱을 옮긴 경우 위치 조정</span>
                <span class="k">this</span><span class="p">.</span><span class="n">Left</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">Left</span> <span class="p">&lt;</span> <span class="m">0</span> <span class="p">?</span>
                    <span class="p">-</span><span class="n">_leftOffset</span> <span class="p">:</span>
                    <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">ActualWidth</span> <span class="p">-</span> <span class="n">_leftOffset</span><span class="p">;</span>

                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">this</span><span class="p">.</span><span class="n">Top</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">Top</span> <span class="p">+</span> <span class="n">_topOffset</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="n">Left</span> <span class="p">=</span> <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">Left</span> <span class="p">+</span> <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">MainWindow</span><span class="p">.</span><span class="n">ActualWidth</span> <span class="p">-</span> <span class="n">_leftOffset</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// GrowlNotificationsView가 렌더된 후 DataContext의 Show, Hide에</span>
        <span class="c1">/// 창 닫기, 열기 메서드를 익명함수로 넘겨 DataContext가 Show, Hide를 호출할 수 있도록 합니다.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">void</span> <span class="nf">GrowlNotificationsView_Loaded</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">DataContext</span> <span class="k">is</span> <span class="n">IWindowFunc</span> <span class="n">vm</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">try</span>
                <span class="p">{</span>
                    <span class="n">vm</span><span class="p">.</span><span class="n">Show</span> <span class="p">=</span> <span class="p">()</span> <span class="p">=&gt;</span>
                    <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nf">Show</span><span class="p">();</span>
                    <span class="p">};</span>

                    <span class="n">vm</span><span class="p">.</span><span class="n">Hide</span> <span class="p">=</span> <span class="p">()</span> <span class="p">=&gt;</span>
                    <span class="p">{</span>
                        <span class="k">this</span><span class="p">.</span><span class="nf">Hide</span><span class="p">();</span>
                    <span class="p">};</span>
                <span class="p">}</span>
                <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">NotificatorWrapper</span><span class="p">.</span><span class="nf">AddNotification</span><span class="p">(</span><span class="k">new</span> <span class="nf">Notification</span><span class="p">(</span><span class="n">MessageType</span><span class="p">.</span><span class="n">custom</span><span class="p">,</span> <span class="s">"[GrowlNotificationsView.xaml.cs] Show() &amp; Hide() 호출 에러 발생."</span><span class="p">,</span> <span class="n">ImageType</span><span class="p">.</span><span class="n">error</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt; Grid의 SizeChanged 이벤트 &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">void</span> <span class="nf">NotificationWindowSizeChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">SizeChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">NewSize</span><span class="p">.</span><span class="n">Height</span> <span class="p">!=</span> <span class="m">0.0</span><span class="p">)</span>
                <span class="k">return</span><span class="p">;</span>

            <span class="kt">int</span> <span class="n">gridTagId</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">Parse</span><span class="p">((</span><span class="n">sender</span> <span class="k">as</span> <span class="n">Grid</span><span class="p">).</span><span class="n">Tag</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>

            <span class="n">NotificatorWrapper</span><span class="p">.</span><span class="nf">RemoveNotification</span><span class="p">(</span><span class="n">gridTagId</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">methods</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Notification이 새로 추가되면 고유 ID를 할당받습니다. 이 고유한 ID는 Notifications 컬렉션에서 Notification 요소를 제거할 때 필요합니다. View에서 팝업창이 하나 사라질 때, 즉 Collapsed 상태가 되면 Height가 0이 됩니다. View의 Code-Behind 영역에서 NotificationWindowSizeChanged 메서드를 통해 Height가 0인 것을 알아차렸을 때(팝업창 하나가 사라짐을 알았을 때) 요소 하나를 제거하도록 합니다.</p><h3 id="viewmodels-growlnotificationsviewmodelcs"><span class="mr-2">ViewModels: <strong>GrowlNotificationsViewModel.cs</strong></span><a href="#viewmodels-growlnotificationsviewmodelcs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>뷰의 뷰모델로서, Notification들을 담는 Notifications 컬렉션을 프로퍼티로 참조해 뷰에 바인딩<li>Notificator 객체가 뷰 Window를 Show 혹은 Hide 할 수 있도록 Action 델리게이트를 인터페이스로 전달받음</ul><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre><span class="k">namespace</span> <span class="nn">__PROJECT_NAMESPACE__</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">__PROJECT_NAME__.Models.Notificates</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">__PROJECT_NAME__.ViewModels.Interfaces</span><span class="p">;</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Notificator.cs의 Notifications &amp; buffer 컬랙션에 담길 Model 데이터 클래스</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">internal</span> <span class="k">class</span> <span class="nc">GrowlNotificationsViewModel</span> <span class="p">:</span> <span class="n">ViewModelBase</span><span class="p">,</span> <span class="n">IWindowFunc</span>
    <span class="p">{</span>
        <span class="err">#</span><span class="n">region</span> <span class="n">fields</span>
        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// NotificationWrapper-&gt;Notification.Notifications ObservableCollection를 참조하는 프로퍼티.</span>
        <span class="c1">/// View와 바인딩되어 있는 Notifications 프로퍼티는 Notificator내의 notifications 객체를 참조하는 형식이다.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="n">Notifications</span> <span class="n">_Notifications</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">fields</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">ctors</span>
        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// MainWindow가 렌더링된 시점에 _growlNotificationsView(GrowlNotificationsView type) 객체 생성. 생성시 코드 플로우는 다음과 같다.</span>
        <span class="c1">/// 1. _growlNotificationsView의 기본생성자 호출</span>
        <span class="c1">/// 2. DataContext에 뷰모델 객체 GrowlNotificationsViewModel() 바인딩</span>
        <span class="c1">/// 3. InitializeComponent() 호출</span>
        <span class="c1">/// 4. GrowlNotificationsView.xaml 코드가 실행되어 각 Element에 대응되는 클래스 생성된 후 렌더링</span>
        <span class="c1">/// 5. GrowlNotificationsView.xaml의 최하단에 ItemsControl의 속성 ItemsSource에 팝업 메시지가 담긴 ObservableCollection 객체 Notifications 바인딩</span>
        <span class="c1">///    ItemsControl의 속성 ItemTemplate에 key 이름이 "MessageTemplate"인 DataTemplate로 지정해 해당 템플릿에서 정의한 스타일 및 애니메이션 기반으로 메시지가 출력되도록 함</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="nf">GrowlNotificationsViewModel</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">_Notifications</span> <span class="p">??=</span> <span class="n">NotificatorWrapper</span><span class="p">.</span><span class="nf">GetNotifications</span><span class="p">();</span>

            <span class="c1">// this에 대한 참조를 Notificator에 주입 (Show(), Hide() 호출 위함)</span>
            <span class="n">NotificatorWrapper</span><span class="p">.</span><span class="nf">InjectDependency</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">ctors</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">properties</span>
        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Singleton Notificator.Notifications 객체 주소를 참조하는 프로퍼티.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="n">Notifications</span> <span class="n">Notifications</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">=&gt;</span> <span class="n">_Notifications</span><span class="p">;</span>

            <span class="k">set</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_Notifications</span> <span class="p">!=</span> <span class="k">value</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">_Notifications</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>

                    <span class="nf">RaisePropertyChanged</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">Notifications</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">GrowlNotificationsView</span> <span class="n">Window</span> <span class="nf">Show</span><span class="p">()</span> <span class="p">&amp;</span> <span class="nf">Hide</span><span class="p">()</span>
        <span class="c1">// GrowlNotificationsView의 Window가 Loaded 상태에 놓여 GrowlNotificationsView_Loaded가 실행됐을 때,</span>
        <span class="c1">// 이 Action 델리게이트에 this.Show()를 포함하는 람다 코드 전달</span>
        <span class="k">public</span> <span class="n">Action</span> <span class="n">Show</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">public</span> <span class="n">Action</span> <span class="n">Hide</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">GrowlNotificationsView</span> <span class="n">Window</span> <span class="nf">Show</span><span class="p">()</span> <span class="p">&amp;</span> <span class="nf">Hide</span><span class="p">()</span>

        <span class="err">#</span><span class="n">endregion</span> <span class="n">properties</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="models-notificationcs"><span class="mr-2">Models: <strong>Notification.cs</strong></span><a href="#models-notificationcs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>GrowlNotificationsView에 컬렉션 형태로 바인딩 될 Model 클래스<li>팝업창의 기본적인 메타데이터 포함<br /> ex) Title, MsgType, Message, ImageUrl, Id<li>외부에서 NotificatorWrapper.AddNotification 및 NotificatorWrapper.RemoveNotification 을 호출할 때 파라미터로 활용됨</ul><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
</pre><td class="rouge-code"><pre><span class="k">namespace</span> <span class="nn">__PROJECT_NAMESPACE__</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Collections.ObjectModel</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">__PROJECT_NAME__.Models.Structures</span><span class="p">;</span>

    <span class="c1">/// &lt;summary&gt; Notification을 담을 컬렉션 &lt;/summary&gt;</span>
    <span class="k">internal</span> <span class="k">class</span> <span class="nc">Notifications</span> <span class="p">:</span> <span class="n">ObservableCollection</span><span class="p">&lt;</span><span class="n">Notification</span><span class="p">&gt;</span> <span class="p">{</span> <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Notificator.cs의 Notifications &amp; buffer 컬랙션에 담길 Model 데이터 클래스</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">internal</span> <span class="k">class</span> <span class="nc">Notification</span> <span class="p">:</span> <span class="n">ViewModelBase</span>
    <span class="p">{</span>
        <span class="err">#</span><span class="n">region</span> <span class="n">fields</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">_Message</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 외부에서 AddNotification 호출시 MessageType을 정의하지 않을 경우</span>
        <span class="c1">/// Custom 메시지로 간주하므로 반드시 Message를 입력해야 함</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="n">MessageType</span> <span class="n">_MsgType</span> <span class="p">=</span> <span class="n">MessageType</span><span class="p">.</span><span class="n">custom</span><span class="p">;</span>

        <span class="k">private</span> <span class="kt">int</span> <span class="n">_Id</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">_ImageUrl</span><span class="p">;</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">_Title</span><span class="p">;</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">fields</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">ctors</span>
        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 메시지 생성자.</span>
        <span class="c1">/// default of imgType = ImageType.info</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="msgType"&gt; 메시지 타입 &lt;/param&gt;</span>
        <span class="c1">/// &lt;param name="msg"&gt; 메시지 &lt;/param&gt;</span>
        <span class="c1">/// &lt;param name="imgType"&gt; 이미지 타입 &lt;/param&gt;</span>
        <span class="k">public</span> <span class="nf">Notification</span><span class="p">(</span><span class="n">MessageType</span> <span class="n">msgType</span><span class="p">,</span> <span class="kt">string</span> <span class="n">msg</span> <span class="p">=</span> <span class="k">null</span><span class="p">,</span> <span class="n">ImageType</span> <span class="n">imgType</span> <span class="p">=</span> <span class="p">(</span><span class="n">ImageType</span><span class="p">)</span><span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">mt</span> <span class="p">=</span> <span class="n">msgType</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">msgType</span> <span class="p">==</span> <span class="n">MessageType</span><span class="p">.</span><span class="n">custom</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="kt">string</span><span class="p">.</span><span class="nf">IsNullOrEmpty</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="nf">NotImplementedException</span><span class="p">(</span><span class="s">"[Notification.cs] 메시지타입이 custom이나, message가 비어있습니다."</span><span class="p">);</span>

                <span class="n">Message</span> <span class="p">=</span> <span class="n">msg</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
                <span class="n">Message</span> <span class="p">=</span> <span class="n">EnumHelper</span><span class="p">.</span><span class="nf">GetDescription</span><span class="p">(</span><span class="n">msgType</span><span class="p">);</span>

            <span class="cm">/*
             * info, warn 그리고 error 이 세 가지의 타입만으론 부족해 더 많은 타입을 추가해야 한다면
             * 타입을 한 단계 더 높게 추상화 하시면 if-else 문을 제거하실 수 있습니다.
             */</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">NotificationType</span><span class="p">.</span><span class="n">infoList</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">mt</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">Title</span> <span class="p">=</span> <span class="n">ImageType</span><span class="p">.</span><span class="n">info</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
                <span class="n">ImageUrl</span> <span class="p">=</span> <span class="n">EnumHelper</span><span class="p">.</span><span class="nf">GetDescription</span><span class="p">(</span><span class="n">ImageType</span><span class="p">.</span><span class="n">info</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">NotificationType</span><span class="p">.</span><span class="n">warningList</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">mt</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">Title</span> <span class="p">=</span> <span class="n">ImageType</span><span class="p">.</span><span class="n">warn</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
                <span class="n">ImageUrl</span> <span class="p">=</span> <span class="n">EnumHelper</span><span class="p">.</span><span class="nf">GetDescription</span><span class="p">(</span><span class="n">ImageType</span><span class="p">.</span><span class="n">warn</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">NotificationType</span><span class="p">.</span><span class="n">errorList</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">mt</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">Title</span> <span class="p">=</span> <span class="n">ImageType</span><span class="p">.</span><span class="n">error</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
                <span class="n">ImageUrl</span> <span class="p">=</span> <span class="n">EnumHelper</span><span class="p">.</span><span class="nf">GetDescription</span><span class="p">(</span><span class="n">ImageType</span><span class="p">.</span><span class="n">error</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="c1">// MessageType.custom</span>
            <span class="p">{</span>
                <span class="n">Title</span> <span class="p">=</span> <span class="n">imgType</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
                <span class="n">ImageUrl</span> <span class="p">=</span> <span class="n">EnumHelper</span><span class="p">.</span><span class="nf">GetDescription</span><span class="p">(</span><span class="n">imgType</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="nf">Notification</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">ctors</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">properties</span>
        <span class="c1">/// &lt;summary&gt; Notification의 본문 메시지 &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Message</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_Message</span><span class="p">;</span> <span class="p">}</span>

            <span class="k">set</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_Message</span> <span class="p">==</span> <span class="k">value</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
                <span class="n">_Message</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">RaisePropertyChanged</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">Message</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt; Notification의 메시지 타입 &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="n">MessageType</span> <span class="n">MsgType</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_MsgType</span><span class="p">;</span> <span class="p">}</span>

            <span class="k">set</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_MsgType</span> <span class="p">==</span> <span class="k">value</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
                <span class="n">MsgType</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">RaisePropertyChanged</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">MsgType</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt; Grid의 Tag ID &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_Id</span><span class="p">;</span> <span class="p">}</span>

            <span class="k">set</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_Id</span> <span class="p">==</span> <span class="k">value</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
                <span class="n">_Id</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">RaisePropertyChanged</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">Id</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt; Notification의 이미지 경로 &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">ImageUrl</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_ImageUrl</span><span class="p">;</span> <span class="p">}</span>

            <span class="k">set</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_ImageUrl</span> <span class="p">==</span> <span class="k">value</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
                <span class="n">_ImageUrl</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">RaisePropertyChanged</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">ImageUrl</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt; Notification의 타이틀 제목 &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Title</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">{</span> <span class="k">return</span> <span class="n">_Title</span><span class="p">;</span> <span class="p">}</span>

            <span class="k">set</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_Title</span> <span class="p">==</span> <span class="k">value</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
                <span class="n">_Title</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="nf">RaisePropertyChanged</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">Title</span><span class="p">));</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">properties</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Notification.cs 클래스에서 48번째 라인부터 사용하는 EnumHelper.GetDescription 메서드는 enum 값에 붙은 Description string 값을 얻게 해주는 역할을 합니다. 코드는 다음과 같습니다.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="k">namespace</span> <span class="nn">__PROJECT_NAMESPACE__</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.ComponentModel</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Reflection</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">EnumHelper</span>
    <span class="p">{</span>
        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Enum의 특정 인덱스의 Description 반환</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="en"&gt; description을 받아올 enum 인덱스 &lt;/param&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetDescription</span><span class="p">(</span><span class="n">Enum</span> <span class="n">en</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Type</span> <span class="n">type</span> <span class="p">=</span> <span class="n">en</span><span class="p">.</span><span class="nf">GetType</span><span class="p">();</span>
            <span class="n">MemberInfo</span><span class="p">[]</span> <span class="n">memInfo</span> <span class="p">=</span> <span class="n">type</span><span class="p">.</span><span class="nf">GetMember</span><span class="p">(</span><span class="n">en</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">memInfo</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">memInfo</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// 해당 인덱스의 Description raw text 추출</span>
                <span class="kt">object</span><span class="p">[]</span> <span class="n">attrs</span> <span class="p">=</span> <span class="n">memInfo</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="nf">GetCustomAttributes</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">DescriptionAttribute</span><span class="p">),</span> <span class="k">false</span><span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">attrs</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">attrs</span><span class="p">.</span><span class="n">Length</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">return</span> <span class="p">((</span><span class="n">DescriptionAttribute</span><span class="p">)</span><span class="n">attrs</span><span class="p">[</span><span class="m">0</span><span class="p">]).</span><span class="n">Description</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">en</span><span class="p">.</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="models-notificatorcs"><span class="mr-2">Models: <strong>Notificator.cs</strong></span><a href="#models-notificatorcs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>Notification을 담는 ObservableCollection _notifications 객체(최대 5개)와 그 5개를 넘는 요소를 임시로 담아놓는 ObservableCollection _buffer 객체(버퍼 역할) 포함<li>Notification을 두 컬렉션에 Boundary check 해가며 Add, Delete 수행하는 로직 포함</ul><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
</pre><td class="rouge-code"><pre><span class="k">namespace</span> <span class="nn">__PROJECT_NAMESPACE__</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">__PROJECT_NAME__.Models.Structures</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">__PROJECT_NAME__.ViewModels.Interfaces</span><span class="p">;</span>

    <span class="k">internal</span> <span class="k">class</span> <span class="nc">Notificator</span> <span class="p">:</span> <span class="n">ViewModelBase</span><span class="p">,</span> <span class="n">IDisposable</span>
    <span class="p">{</span>
        <span class="err">#</span><span class="n">region</span> <span class="n">fields</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="n">log4net</span><span class="p">.</span><span class="n">ILog</span> <span class="n">logger</span> <span class="p">=</span> <span class="n">log4net</span><span class="p">.</span><span class="n">LogManager</span><span class="p">.</span><span class="nf">GetLogger</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">MethodBase</span><span class="p">.</span><span class="nf">GetCurrentMethod</span><span class="p">().</span><span class="n">DeclaringType</span><span class="p">);</span>

        <span class="c1">/// &lt;summary&gt; 최대 메시지 수 &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kt">byte</span> <span class="n">MAX_NOTIFICATIONS</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt; 최대 버퍼 메시지 수 &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">const</span> <span class="kt">byte</span> <span class="n">MAX_BUFFER_SIZE</span> <span class="p">=</span> <span class="m">8</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt; 메시지 카운트 &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="kt">int</span> <span class="n">_count</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Notification 메시지들이 담긴 ObservableCollection.</span>
        <span class="c1">/// GrowlNotificationsView의 ItemsControl에 바인딩됨</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">Notifications</span> <span class="n">_notifications</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Notifications</span><span class="p">();</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 팝업창을 닫기 위해 GrowlNotificationsView의</span>
        <span class="c1">/// Show, Hide 델리게이트 참조</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">static</span> <span class="n">IWindowFunc</span> <span class="n">_growlNotificationsViewModel</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// "if) count &gt; MAX_NOTIFICATIONS == true" 일 경우</span>
        <span class="c1">/// 담을 buffer ObservableCollection</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="n">Notifications</span> <span class="n">_buffer</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Notifications</span><span class="p">();</span>

        <span class="c1">/// &lt;summary&gt; 중복 호출 검색 &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="kt">bool</span> <span class="n">_disposedValue</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">fields</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">methods</span>
        <span class="c1">/// &lt;summary&gt; Notificator의 Notifications를 Get &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="n">Notifications</span> <span class="nf">GetNotifications</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">_notifications</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// GrowlNotificationsViewModel 객체를 Injection 받는 메서드.</span>
        <span class="c1">/// 본 클래스에서 팝업창 Show(), Hide() 활용 가능</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="vm"&gt; Show, Hide 액션 프로퍼티 &lt;/param&gt;</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">InjectDependency</span><span class="p">(</span><span class="n">IWindowFunc</span> <span class="n">vm</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_growlNotificationsViewModel</span> <span class="p">=</span> <span class="n">vm</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Notifications ObervableCollection에 Notification 객체 enqueue.</span>
        <span class="c1">/// UI Thread와 현재 Thread의 상이함(Cross-Thread issue)을 해결하기 위해</span>
        <span class="c1">/// AppDomain의 Dispatcher thread에 delegate 코드 위임</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="notification"&gt; 팝업창 Model &lt;/param&gt;</span>
        <span class="k">private</span> <span class="k">void</span> <span class="nf">Add</span><span class="p">(</span><span class="n">Notification</span> <span class="n">notification</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Dispatcher</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="k">new</span> <span class="nf">Action</span><span class="p">(()</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="n">_notifications</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">notification</span><span class="p">);</span>
            <span class="p">}));</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Notifications에서 노드 하나 Remove</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="notification"&gt; 팝업창 Model &lt;/param&gt;</span>
        <span class="k">private</span> <span class="k">void</span> <span class="nf">Remove</span><span class="p">(</span><span class="n">Notification</span> <span class="n">notification</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Dispatcher</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="k">new</span> <span class="nf">Action</span><span class="p">(()</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="n">_notifications</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">notification</span><span class="p">);</span>
            <span class="p">}));</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// GrowlNotificationsView Window를 Show</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">void</span> <span class="nf">Show</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Dispatcher</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="k">new</span> <span class="nf">Action</span><span class="p">(()</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="n">_growlNotificationsViewModel</span><span class="p">.</span><span class="nf">Show</span><span class="p">();</span>
            <span class="p">}));</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// GrowlNotificationsView Window를 Hide</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">private</span> <span class="k">void</span> <span class="nf">Hide</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">App</span><span class="p">.</span><span class="n">Current</span><span class="p">.</span><span class="n">Dispatcher</span><span class="p">.</span><span class="nf">Invoke</span><span class="p">(</span><span class="k">new</span> <span class="nf">Action</span><span class="p">(()</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="n">_growlNotificationsViewModel</span><span class="p">.</span><span class="nf">Hide</span><span class="p">();</span>
            <span class="p">}));</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// 메시지를 버퍼에 추가.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="notification"&gt; 팝업창 Model &lt;/param&gt;</span>
        <span class="k">private</span> <span class="k">void</span> <span class="nf">AddToBuffer</span><span class="p">(</span><span class="n">Notification</span> <span class="n">notification</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(!</span><span class="nf">CheckLimitation</span><span class="p">())</span>
                <span class="k">return</span><span class="p">;</span>

            <span class="n">_buffer</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">notification</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Notifications 큐 컬렉션에 Notification 추가.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="notification"&gt;&lt;/param&gt;</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">AddNotification</span><span class="p">(</span><span class="n">Notification</span> <span class="n">notification</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="n">notification</span><span class="p">.</span><span class="n">Id</span> <span class="p">=</span> <span class="n">_count</span><span class="p">++;</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_notifications</span><span class="p">.</span><span class="n">Count</span> <span class="p">+</span> <span class="m">1</span> <span class="p">&gt;</span> <span class="n">MAX_NOTIFICATIONS</span><span class="p">)</span>
                    <span class="nf">AddToBuffer</span><span class="p">(</span><span class="n">notification</span><span class="p">);</span>
                <span class="k">else</span>
                    <span class="nf">Add</span><span class="p">(</span><span class="n">notification</span><span class="p">);</span>

                <span class="c1">// notifications가 있을 경우 window를 띄움</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_notifications</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                    <span class="nf">Show</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">System</span><span class="p">.</span><span class="n">Diagnostics</span><span class="p">.</span><span class="n">Debug</span><span class="p">.</span><span class="nf">Print</span><span class="p">(</span><span class="n">ex</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
                <span class="n">logger</span><span class="p">.</span><span class="nf">Error</span><span class="p">(</span><span class="s">$"Notificator 에러 발생. \n</span><span class="p">{</span><span class="n">ex</span><span class="p">}</span><span class="s">\n"</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Notifications 큐 컬렉션에 Notification 제거.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="gridTagId"&gt; 제거할 Notification Model ID &lt;/param&gt;</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">RemoveNotification</span><span class="p">(</span><span class="kt">int</span> <span class="n">gridTagId</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// 제거해야 하는 Notification 쿼리</span>
            <span class="n">Notification</span> <span class="n">nodeToDelete</span> <span class="p">=</span> <span class="n">_notifications</span><span class="p">.</span><span class="nf">First</span><span class="p">(</span><span class="n">n</span> <span class="p">=&gt;</span> <span class="n">n</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="n">gridTagId</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">nodeToDelete</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nf">NotImplementedException</span><span class="p">(</span><span class="s">"[Notificator.cs] nodeToDelete == null"</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">_notifications</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">nodeToDelete</span><span class="p">))</span>
                <span class="nf">Remove</span><span class="p">(</span><span class="n">nodeToDelete</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">_buffer</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="nf">Add</span><span class="p">(</span><span class="n">_buffer</span><span class="p">[</span><span class="m">0</span><span class="p">]);</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">_buffer</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                    <span class="n">_buffer</span><span class="p">.</span><span class="nf">RemoveAt</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="c1">// 더이상 보여줄 notifications가 없을 경우 윈도우 닫음</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">_notifications</span><span class="p">.</span><span class="n">Count</span> <span class="p">&lt;</span> <span class="m">1</span><span class="p">)</span>
                <span class="nf">Hide</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="kt">bool</span> <span class="nf">CheckLimitation</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">try</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">_buffer</span><span class="p">.</span><span class="n">Count</span> <span class="p">+</span> <span class="m">1</span><span class="p">)</span> <span class="p">&gt;</span> <span class="n">MAX_BUFFER_SIZE</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">(</span><span class="s">"작업 요청이 너무 많습니다. 잠시 후 다시 시도해 주세요."</span><span class="p">,</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="nf">InvalidOperationException</span><span class="p">());</span>
                <span class="p">}</span>

                <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// buffer의 맨 앞 요소 제거 후 위 Exception 메시지 추가</span>
                <span class="n">_buffer</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

                <span class="n">NotificatorWrapper</span><span class="p">.</span><span class="nf">AddNotification</span><span class="p">(</span><span class="k">new</span> <span class="nf">Notification</span><span class="p">(</span><span class="n">MessageType</span><span class="p">.</span><span class="n">custom</span><span class="p">,</span> <span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">,</span> <span class="n">ImageType</span><span class="p">.</span><span class="n">error</span><span class="p">));</span>

                <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">methods</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">IDisposable</span> <span class="n">Support</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="nf">Dispose</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">protected</span> <span class="k">virtual</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">(</span><span class="kt">bool</span> <span class="n">disposing</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(!</span><span class="n">_disposedValue</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">disposing</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">_notifications</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
                    <span class="n">_buffer</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="n">_disposedValue</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">IDisposable</span> <span class="n">Support</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="models-notificatorwrappercs"><span class="mr-2">Models: <strong>NotificatorWrapper.cs</strong></span><a href="#models-notificatorwrappercs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>Notificator를 캡슐화<li>Notificator를 외부에서 호출할 수 있도록 static으로 만들었으며, 유일한 객체를 가지므로 Singleton 역할을 함 (Redundancy DCL)<li>MainWindow OnClosing 시점에 Raise 되는 메서드 내 초입에서 Dispose 호출해 메모리 명시적 수집. (프로그램이 닫혔는데도 메모리상 static 객체가 동적 객체를 지속해서 참조하는 행위 방지)</ul><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
</pre><td class="rouge-code"><pre><span class="k">namespace</span> <span class="nn">__PROJECT_NAMESPACE__</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
    <span class="k">using</span> <span class="nn">__PROJECT_NAME__.ViewModels.Interfaces</span><span class="p">;</span>

    <span class="k">internal</span> <span class="k">class</span> <span class="nc">NotificatorWrapper</span>
    <span class="p">{</span>
        <span class="err">#</span><span class="n">region</span> <span class="n">fields</span>
        <span class="k">private</span> <span class="k">static</span> <span class="n">NotificatorWrapper</span> <span class="n">_instance</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">Notificator</span> <span class="n">Origin</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">private</span> <span class="k">static</span> <span class="k">readonly</span> <span class="kt">object</span> <span class="n">lockObj</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">();</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">fields</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">ctors</span>
        <span class="k">private</span> <span class="nf">NotificatorWrapper</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Origin</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Notificator</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">ctors</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">properties</span>
        <span class="k">private</span> <span class="k">static</span> <span class="n">NotificatorWrapper</span> <span class="n">Instance</span>
        <span class="p">{</span>
            <span class="k">get</span>
            <span class="p">{</span>
                <span class="c1">// double-checked locking</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_instance</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">lock</span> <span class="p">(</span><span class="n">lockObj</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">_instance</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="n">_instance</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">NotificatorWrapper</span><span class="p">();</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="k">return</span> <span class="n">_instance</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">properties</span>

        <span class="err">#</span><span class="n">region</span> <span class="n">methods</span>
        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// GrowlNotificationsViewModel 객체를 Injection 받는 메서드.</span>
        <span class="c1">/// Notificator 클래스에서 팝업창 Show(), Hide() 할 수 있도록 주입</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="vm"&gt; Show, Hide 액션 프로퍼티 &lt;/param&gt;</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">InjectDependency</span><span class="p">(</span><span class="n">IWindowFunc</span> <span class="n">vm</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Instance</span><span class="p">.</span><span class="n">Origin</span><span class="p">.</span><span class="nf">InjectDependency</span><span class="p">(</span><span class="n">vm</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Notificator의 Notifications를 return하여 참조할 수 있도록 함.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="n">Notifications</span> <span class="nf">GetNotifications</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">Instance</span><span class="p">.</span><span class="n">Origin</span><span class="p">.</span><span class="nf">GetNotifications</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Notifications 큐 컬렉션에 Notification 추가.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="notification"&gt;&lt;/param&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">AddNotification</span><span class="p">(</span><span class="n">Notification</span> <span class="n">notification</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Invoke to Thread Pool Thread to avoid overhead using fire &amp; forget</span>
            <span class="n">Task</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="k">new</span> <span class="nf">Action</span><span class="p">(()</span> <span class="p">=&gt;</span>
                <span class="n">Instance</span><span class="p">.</span><span class="n">Origin</span><span class="p">.</span><span class="nf">AddNotification</span><span class="p">(</span><span class="n">notification</span><span class="p">)</span>
            <span class="p">)).</span><span class="nf">ConfigureAwait</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Notifications 큐 컬렉션에서 Notification 제거.</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="gridTagId"&gt;&lt;/param&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">RemoveNotification</span><span class="p">(</span><span class="kt">int</span> <span class="n">gridTagId</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Task</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="k">new</span> <span class="nf">Action</span><span class="p">(()</span> <span class="p">=&gt;</span>
                <span class="n">Instance</span><span class="p">.</span><span class="n">Origin</span><span class="p">.</span><span class="nf">RemoveNotification</span><span class="p">(</span><span class="n">gridTagId</span><span class="p">)</span>
            <span class="p">)).</span><span class="nf">ConfigureAwait</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Release</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Instance</span><span class="p">.</span><span class="n">Origin</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>

            <span class="n">_instance</span> <span class="p">=</span> <span class="k">null</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="err">#</span><span class="n">endregion</span> <span class="n">methods</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>팝업창을 띄우려면 다음과 같이 Wrapper 객체의 AddNotification 메서드를 호출하면 됩니다.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1">// 사용자 정의 메시지 팝업</span>
<span class="n">NotificatorWrapper</span><span class="p">.</span><span class="nf">AddNotification</span><span class="p">(</span><span class="k">new</span> <span class="nf">Notification</span><span class="p">(</span><span class="n">MessageType</span><span class="p">.</span><span class="n">custom</span><span class="p">,</span> <span class="s">$"[EXE:Communicator] </span><span class="p">{</span><span class="n">errMsg</span><span class="p">}</span><span class="s">"</span><span class="p">,</span> <span class="n">ImageType</span><span class="p">.</span><span class="n">error</span><span class="p">));</span>

<span class="n">NotificatorWrapper</span><span class="p">.</span><span class="nf">AddNotification</span><span class="p">(</span>
    <span class="k">new</span> <span class="nf">Notification</span><span class="p">(</span><span class="n">MessageType</span><span class="p">.</span><span class="n">custom</span><span class="p">,</span>
    <span class="s">$"An unexpected error occurred. see /logs/global/[</span><span class="p">{</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">:</span><span class="n">yyyy</span><span class="p">.</span><span class="n">mm</span><span class="p">.</span><span class="n">dd</span><span class="p">}</span><span class="s">]global.txt file."</span><span class="p">,</span>
    <span class="n">ImageType</span><span class="p">.</span><span class="n">error</span><span class="p">));</span>

<span class="c1">// 메시지 타입에 따른 메시지 팝업</span>
<span class="n">NotificatorWrapper</span><span class="p">.</span><span class="nf">AddNotification</span><span class="p">(</span><span class="k">new</span> <span class="nf">Notification</span><span class="p">(</span><span class="n">MessageType</span><span class="p">.</span><span class="n">noPortAvailable</span><span class="p">));</span>

<span class="n">NotificatorWrapper</span><span class="p">.</span><span class="nf">AddNotification</span><span class="p">(</span><span class="k">new</span> <span class="nf">Notification</span><span class="p">(</span><span class="n">MessageType</span><span class="p">.</span><span class="n">noSlaveScanned</span><span class="p">));</span>
</pre></table></code></div></div><h3 id="iwindowfunccs"><span class="mr-2">IWindowFunc.cs</span><a href="#iwindowfunccs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>Notificator 객체가 GrowlNotificationsViewModel 객체의 Window 창을 보여주거나 가릴 수 있도록 액션 프로퍼티 Show, Hide를 노출한 인터페이스</ul><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">namespace</span> <span class="nn">__PROJECT_NAMESPACE__</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

    <span class="k">internal</span> <span class="k">interface</span> <span class="nc">IWindowFunc</span>
    <span class="p">{</span>
        <span class="c1">/// &lt;summary&gt; Window Show()를 호출하는 메서드. &lt;/summary&gt;</span>
        <span class="n">Action</span> <span class="n">Show</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt; Window Hide()를 호출하는 메서드. &lt;/summary&gt;</span>
        <span class="n">Action</span> <span class="n">Hide</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt; Window OnClosing 시 호출되는 메서드. &lt;/summary&gt;</span>
        <span class="k">void</span> <span class="nf">OnClosing</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="notificationtypecs"><span class="mr-2"><strong>NotificationType.cs</strong></span><a href="#notificationtypecs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>알림에 대한 메시지 타입들을 enum 형태로 저장<li>Notificator 클래스와 Add, Remove하는 외부 클래스에서 참조됨</ul><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
</pre><td class="rouge-code"><pre><span class="k">namespace</span> <span class="nn">__PROJECT_NAMESPACE__</span>
<span class="p">{</span>
    <span class="k">using</span> <span class="nn">System.ComponentModel</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">enum</span> <span class="n">MessageType</span>
    <span class="p">{</span>
        <span class="c1">// 아래 enum 타입에 없는 경우 커스텀 메시지로 분기</span>
        <span class="n">custom</span><span class="p">,</span>

        <span class="p">[</span><span class="nf">Description</span><span class="p">(</span><span class="s">"연결에 성공했습니다."</span><span class="p">)]</span>
        <span class="n">connectionSuccess</span><span class="p">,</span>

        <span class="p">[</span><span class="nf">Description</span><span class="p">(</span><span class="s">"타임아웃이 발생했습니다."</span><span class="p">)]</span>
        <span class="n">timeout</span><span class="p">,</span>

        <span class="p">[</span><span class="nf">Description</span><span class="p">(</span><span class="s">"포트에 접근할 수 없습니다."</span><span class="p">)]</span>
        <span class="n">portOccupied</span><span class="p">,</span>

        <span class="c1">// etc...</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">enum</span> <span class="n">ImageType</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="nf">Description</span><span class="p">(</span><span class="s">"pack://application:,,,/Resources/info.png"</span><span class="p">)]</span>
        <span class="n">info</span><span class="p">,</span>                    <span class="cm">/* 알림 */</span>

        <span class="p">[</span><span class="nf">Description</span><span class="p">(</span><span class="s">"pack://application:,,,/Resources/warning.png"</span><span class="p">)]</span>
        <span class="n">warn</span><span class="p">,</span>                    <span class="cm">/* 주의 */</span>

        <span class="p">[</span><span class="nf">Description</span><span class="p">(</span><span class="s">"pack://application:,,,/Resources/error.png"</span><span class="p">)]</span>
        <span class="n">error</span><span class="p">,</span>                   <span class="cm">/* 경고 */</span>

        <span class="c1">// etc...</span>
    <span class="p">}</span>

    <span class="c1">/// &lt;summary&gt; MessageType에 따른 ImageType 그룹핑 &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">NotificationType</span>
    <span class="p">{</span>
        <span class="c1">/// &lt;summary&gt; Info 그룹 &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">infoList</span> <span class="p">=</span>
        <span class="p">{</span>
            <span class="s">"portOccupied"</span><span class="p">,</span>
            <span class="s">"noPortAvailable"</span><span class="p">,</span>
            <span class="s">"modbus_aleadyConnected"</span><span class="p">,</span>
            <span class="s">"modbus_connected"</span><span class="p">,</span>
        <span class="p">};</span>

        <span class="c1">/// &lt;summary&gt; Warning 그룹 &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">warningList</span> <span class="p">=</span>
        <span class="p">{</span>
            <span class="s">"timeout"</span><span class="p">,</span>
            <span class="s">"modbus_slaveError_read"</span><span class="p">,</span>
            <span class="s">"modbus_slaveError_write"</span><span class="p">,</span>
            <span class="s">"rxLimitDetected"</span><span class="p">,</span>
        <span class="p">};</span>

        <span class="c1">/// &lt;summary&gt; Error 그룹 &lt;/summary&gt;</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">errorList</span> <span class="p">=</span>
        <span class="p">{</span>
            <span class="s">"modbus_crcError"</span><span class="p">,</span>
            <span class="s">"modbus_connectionFailed"</span><span class="p">,</span>
            <span class="s">"serial_initError"</span><span class="p">,</span>
        <span class="p">};</span>

        <span class="c1">// etc...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="appxamlcs"><span class="mr-2">App.xaml.cs</span><a href="#appxamlcs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>팝업창은 글로벌 영역에서 생성되어야 하므로 App.xaml.cs 에서 생성합니다.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1">// ... App 렌더링 완료 직후 ...</span>

<span class="c1">// 팝업 윈도우 생성. _mainWindow의 Left, Top, Width를 참조하므로 메인윈도우 생성 후 생성</span>
<span class="n">_growlNotificationsView</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GrowlNotificationsView</span><span class="p">();</span>

<span class="cm">/*
 * _growlNotificationsView 윈도우의 소유권을 _mainWindow로 넘김
 * (참조: https://docs.microsoft.com/ko-kr/dotnet/api/system.windows.window.owner?view=netcore-3.1)
 */</span>
<span class="n">_growlNotificationsView</span><span class="p">.</span><span class="n">Owner</span> <span class="p">=</span> <span class="n">_mainWindow</span><span class="p">;</span>
</pre></table></code></div></div><p>글 초입에 말씀 드렸듯이 PC 화면 우상단에 anchor되는 것이 아닌 프로그램 우상단에 anchor되도록 구현합니다.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 메인윈도우 Top, Left 위치 변동 감지시 팝업창 위치를</span>
<span class="c1">/// 메인윈도우 우상단에 고정되도록 조정</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt; AppDomain &lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">MainWindow_LocationChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">window</span> <span class="p">=</span> <span class="n">sender</span> <span class="k">as</span> <span class="n">Window</span><span class="p">;</span>

    <span class="c1">// MainWindow가 Maximized 상태가 아닌 경우에만 변경해야 함</span>
    <span class="k">if</span> <span class="p">(!</span><span class="n">window</span><span class="p">.</span><span class="n">WindowState</span><span class="p">.</span><span class="nf">Equals</span><span class="p">(</span><span class="n">WindowState</span><span class="p">.</span><span class="n">Maximized</span><span class="p">))</span>
        <span class="n">_growlNotificationsView</span><span class="p">?.</span><span class="nf">SetLocation</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 메인윈도우 ActualWidth, ActualHeight 너비 변동 감지시</span>
<span class="c1">/// 팝업창 위치를 메인윈도우 우상단에 고정되도록 조정</span>
<span class="c1">/// &lt;/summary&gt;</span>
<span class="c1">/// &lt;param name="sender"&gt; AppDomain &lt;/param&gt;</span>
<span class="k">private</span> <span class="k">void</span> <span class="nf">MainWindow_SizeChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">SizeChangedEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">_growlNotificationsView</span><span class="p">?.</span><span class="nf">SetActualLocation</span><span class="p">();</span>
<span class="p">}</span>
</pre></table></code></div></div><p>앱 종료 시에도 지속적으로 값을 참조하는 hanging 문제를 피하기 위해 앱 종료(App.OnClosing) 시점에 명시적으로 _growlNotifiactionsView.Close() 를 호출하도록 합니다.</p><div class="language-csharp highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">_growlNotificationsView</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>
</pre></table></code></div></div><p><br /><br /><br /> <strong><em>References</em></strong></p><hr /><ul><li><a href="https://www.codeproject.com/Articles/499241/Growl-Alike-WPF-Notifications"><em>Growl Alike WPF Notifications</em></a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/c/'>C#</a>, <a href='/categories/wpf/'>WPF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/wpf/" class="post-tag no-text-decoration" >WPF</a> <a href="/tags/mvvm/" class="post-tag no-text-decoration" >MVVM</a> <a href="/tags/popup-notification/" class="post-tag no-text-decoration" >Popup Notification</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[WPF] 팝업 알림창 MVVM 패턴으로 구현하기 - Sunhyeok Choe&amp;url=https://sunhyeokchoe.github.io/posts/Growl-Notification/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[WPF] 팝업 알림창 MVVM 패턴으로 구현하기 - Sunhyeok Choe&amp;u=https://sunhyeokchoe.github.io/posts/Growl-Notification/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://sunhyeokchoe.github.io/posts/Growl-Notification/&amp;text=[WPF] 팝업 알림창 MVVM 패턴으로 구현하기 - Sunhyeok Choe" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Growl-Notification/">[WPF] 팝업 알림창 MVVM 패턴으로 구현하기</a><li><a href="/posts/Contributing-to-a-Project/">[Git] 분산 환경에서 프로젝트에 기여하기</a><li><a href="/posts/Working-with-Remotes/">[Git] 리모트 저장소</a><li><a href="/posts/Branch-Management/">[Git] 브랜치 관리</a><li><a href="/posts/Branching-Workflows/">[Git] 브랜치 워크플로</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dvcs/">DVCS</a> <a class="post-tag" href="/tags/git/">Git</a> <a class="post-tag" href="/tags/github/">Github</a> <a class="post-tag" href="/tags/vcs/">VCS</a> <a class="post-tag" href="/tags/git-branch/">git branch</a> <a class="post-tag" href="/tags/commit-history/">Commit History</a> <a class="post-tag" href="/tags/git-commit/">git commit</a> <a class="post-tag" href="/tags/git-merge/">git merge</a> <a class="post-tag" href="/tags/git-remote/">git remote</a> <a class="post-tag" href="/tags/git-switch/">git switch</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/oneM2M-application-development-procedure-(1)/"><div class="card-body"> <em class="timeago small" data-ts="1645208358" > 2022-02-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>2. oneM2M 애플리케이션 개발 절차 (1)</h3><div class="text-muted small"><p> 원격 조명 제어 유스케이스 개요 원세종 군은 하루 일과를 마친 후 지친 몸을 이끌고 집으로 귀가했다. 집에 혼자 살고 있기 때문에 귀가했을 때 집 안에 있는 불은 모두 꺼져있는 상황이다. oneM2M 사물 인터넷 서비스를 사용하지 않았던 한달 전까지만 해도, 원세종 군은 귀가 후에 거실, 주방, 화장실 등의 불을 일일이 켜고, 취침 전에는 다시 ...</p></div></div></a></div><div class="card"> <a href="/posts/oneM2M-technical-standards-and-technical-documents/"><div class="card-body"> <em class="timeago small" data-ts="1645196708" > 2022-02-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>1. oneM2M 기술규격 및 기술문서 소개</h3><div class="text-muted small"><p> 개요 oneM2M은 에너지, 교통, 국방, 공공서비스 등 산업별로 종속적이고 폐쇄적으로 운영되는, 파편화된 서비스 플랫폼 개발 구조를 벗어나 응용서비스 인프라(플랫폼) 환경을 통합하고 공유하기 위한 사물인터넷 공통서비스 플랫폼 개발을 위해 발족된 사실상 표준화 단체이다. 전세계 지역별 표준 개발 기구인 TTA(한국), ETSI(유럽), ATIS...</p></div></div></a></div><div class="card"> <a href="/posts/Contributing-to-a-Project/"><div class="card-body"> <em class="timeago small" data-ts="1642065658" > 2022-01-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Git] 분산 환경에서 프로젝트에 기여하기</h3><div class="text-muted small"><p> 기여하는 방식에 영향을 끼치는 변수가 다음과 같이 몇 가지 있다. 활발히 기여하는 개발자의 수가 몇인지 선택한 워크플로가 무엇인지 각 개발자에게 접근 권한을 어떻게 부여했는지 외부에서도 기여할 수 있는지 (접근 권한) 첫 번째로 살펴볼 변수는 활발히 활동하는 개발자의 수이다. 이 활발한 개발자에 대한 기준은 얼마나 잦은 빈도로 코...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Contributing-to-a-Project/" class="btn btn-outline-primary" prompt="이전 글"><p>[Git] 분산 환경에서 프로젝트에 기여하기</p></a> <a href="/posts/oneM2M-technical-standards-and-technical-documents/" class="btn btn-outline-primary" prompt="다음 글"><p>1. oneM2M 기술규격 및 기술문서 소개</p></a></div><script src="https://utteranc.es/client.js" repo="SunhyeokChoe/SunhyeokChoe.github.io" issue-term="url" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/SunhyeokChoe">SunhyeokChoe</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dvcs/">DVCS</a> <a class="post-tag" href="/tags/git/">Git</a> <a class="post-tag" href="/tags/github/">Github</a> <a class="post-tag" href="/tags/vcs/">VCS</a> <a class="post-tag" href="/tags/git-branch/">git branch</a> <a class="post-tag" href="/tags/commit-history/">Commit History</a> <a class="post-tag" href="/tags/git-commit/">git commit</a> <a class="post-tag" href="/tags/git-merge/">git merge</a> <a class="post-tag" href="/tags/git-remote/">git remote</a> <a class="post-tag" href="/tags/git-switch/">git switch</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-0ZQ0CWNMX0"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-0ZQ0CWNMX0'); }); </script>
